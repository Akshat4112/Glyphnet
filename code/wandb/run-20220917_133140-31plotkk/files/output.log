Model: "model"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to
==================================================================================================
 input_1 (InputLayer)           [(None, 256, 256, 3  0           []
                                )]
 rescaling (Rescaling)          (None, 256, 256, 3)  0           ['input_1[0][0]']
 conv2d (Conv2D)                (None, 252, 252, 32  2432        ['rescaling[0][0]']
                                )
 max_pooling2d (MaxPooling2D)   (None, 126, 126, 32  0           ['conv2d[0][0]']
                                )
 global_average_pooling2d (Glob  (None, 32)          0           ['max_pooling2d[0][0]']
 alAveragePooling2D)
 global_max_pooling2d (GlobalMa  (None, 32)          0           ['max_pooling2d[0][0]']
 xPooling2D)
 reshape (Reshape)              (None, 1, 1, 32)     0           ['global_average_pooling2d[0][0]'
                                                                 ]
 reshape_1 (Reshape)            (None, 1, 1, 32)     0           ['global_max_pooling2d[0][0]']
 dense (Dense)                  (None, 1, 1, 4)      132         ['reshape[0][0]',
                                                                  'reshape_1[0][0]']
 dense_1 (Dense)                (None, 1, 1, 32)     160         ['dense[0][0]',
                                                                  'dense[1][0]']
 add (Add)                      (None, 1, 1, 32)     0           ['dense_1[0][0]',
                                                                  'dense_1[1][0]']
 activation (Activation)        (None, 1, 1, 32)     0           ['add[0][0]']
 multiply (Multiply)            (None, 126, 126, 32  0           ['max_pooling2d[0][0]',
                                )                                 'activation[0][0]']
 lambda (Lambda)                (None, 126, 126, 1)  0           ['multiply[0][0]']
 lambda_1 (Lambda)              (None, 126, 126, 1)  0           ['multiply[0][0]']
 concatenate (Concatenate)      (None, 126, 126, 2)  0           ['lambda[0][0]',
                                                                  'lambda_1[0][0]']
 conv2d_1 (Conv2D)              (None, 126, 126, 1)  98          ['concatenate[0][0]']
 multiply_1 (Multiply)          (None, 126, 126, 32  0           ['multiply[0][0]',
                                )                                 'conv2d_1[0][0]']
 batch_normalization (BatchNorm  (None, 126, 126, 32  128        ['multiply_1[0][0]']
 alization)                     )
 conv2d_2 (Conv2D)              (None, 124, 124, 64  18496       ['batch_normalization[0][0]']
                                )
 max_pooling2d_1 (MaxPooling2D)  (None, 62, 62, 64)  0           ['conv2d_2[0][0]']
 global_average_pooling2d_1 (Gl  (None, 64)          0           ['max_pooling2d_1[0][0]']
 obalAveragePooling2D)
 global_max_pooling2d_1 (Global  (None, 64)          0           ['max_pooling2d_1[0][0]']
 MaxPooling2D)
 reshape_2 (Reshape)            (None, 1, 1, 64)     0           ['global_average_pooling2d_1[0][0
                                                                 ]']
 reshape_3 (Reshape)            (None, 1, 1, 64)     0           ['global_max_pooling2d_1[0][0]']
 dense_2 (Dense)                (None, 1, 1, 8)      520         ['reshape_2[0][0]',
                                                                  'reshape_3[0][0]']
 dense_3 (Dense)                (None, 1, 1, 64)     576         ['dense_2[0][0]',
                                                                  'dense_2[1][0]']
 add_1 (Add)                    (None, 1, 1, 64)     0           ['dense_3[0][0]',
                                                                  'dense_3[1][0]']
 activation_1 (Activation)      (None, 1, 1, 64)     0           ['add_1[0][0]']
 multiply_2 (Multiply)          (None, 62, 62, 64)   0           ['max_pooling2d_1[0][0]',
                                                                  'activation_1[0][0]']
 lambda_2 (Lambda)              (None, 62, 62, 1)    0           ['multiply_2[0][0]']
 lambda_3 (Lambda)              (None, 62, 62, 1)    0           ['multiply_2[0][0]']
 concatenate_1 (Concatenate)    (None, 62, 62, 2)    0           ['lambda_2[0][0]',
                                                                  'lambda_3[0][0]']
 conv2d_3 (Conv2D)              (None, 62, 62, 1)    98          ['concatenate_1[0][0]']
 multiply_3 (Multiply)          (None, 62, 62, 64)   0           ['multiply_2[0][0]',
                                                                  'conv2d_3[0][0]']
 batch_normalization_1 (BatchNo  (None, 62, 62, 64)  256         ['multiply_3[0][0]']
 rmalization)
 conv2d_4 (Conv2D)              (None, 60, 60, 64)   36928       ['batch_normalization_1[0][0]']
 max_pooling2d_2 (MaxPooling2D)  (None, 30, 30, 64)  0           ['conv2d_4[0][0]']
 global_average_pooling2d_2 (Gl  (None, 64)          0           ['max_pooling2d_2[0][0]']
 obalAveragePooling2D)
 global_max_pooling2d_2 (Global  (None, 64)          0           ['max_pooling2d_2[0][0]']
 MaxPooling2D)
 reshape_4 (Reshape)            (None, 1, 1, 64)     0           ['global_average_pooling2d_2[0][0
                                                                 ]']
 reshape_5 (Reshape)            (None, 1, 1, 64)     0           ['global_max_pooling2d_2[0][0]']
 dense_4 (Dense)                (None, 1, 1, 8)      520         ['reshape_4[0][0]',
                                                                  'reshape_5[0][0]']
 dense_5 (Dense)                (None, 1, 1, 64)     576         ['dense_4[0][0]',
                                                                  'dense_4[1][0]']
 add_2 (Add)                    (None, 1, 1, 64)     0           ['dense_5[0][0]',
                                                                  'dense_5[1][0]']
 activation_2 (Activation)      (None, 1, 1, 64)     0           ['add_2[0][0]']
 multiply_4 (Multiply)          (None, 30, 30, 64)   0           ['max_pooling2d_2[0][0]',
                                                                  'activation_2[0][0]']
 lambda_4 (Lambda)              (None, 30, 30, 1)    0           ['multiply_4[0][0]']
 lambda_5 (Lambda)              (None, 30, 30, 1)    0           ['multiply_4[0][0]']
 concatenate_2 (Concatenate)    (None, 30, 30, 2)    0           ['lambda_4[0][0]',
                                                                  'lambda_5[0][0]']
 conv2d_5 (Conv2D)              (None, 30, 30, 1)    98          ['concatenate_2[0][0]']
 multiply_5 (Multiply)          (None, 30, 30, 64)   0           ['multiply_4[0][0]',
                                                                  'conv2d_5[0][0]']
 conv2d_6 (Conv2D)              (None, 28, 28, 128)  73856       ['multiply_5[0][0]']
 max_pooling2d_3 (MaxPooling2D)  (None, 14, 14, 128)  0          ['conv2d_6[0][0]']
 global_average_pooling2d_3 (Gl  (None, 128)         0           ['max_pooling2d_3[0][0]']
 obalAveragePooling2D)
 global_max_pooling2d_3 (Global  (None, 128)         0           ['max_pooling2d_3[0][0]']
 MaxPooling2D)
 reshape_6 (Reshape)            (None, 1, 1, 128)    0           ['global_average_pooling2d_3[0][0
                                                                 ]']
 reshape_7 (Reshape)            (None, 1, 1, 128)    0           ['global_max_pooling2d_3[0][0]']
 dense_6 (Dense)                (None, 1, 1, 16)     2064        ['reshape_6[0][0]',
                                                                  'reshape_7[0][0]']
 dense_7 (Dense)                (None, 1, 1, 128)    2176        ['dense_6[0][0]',
                                                                  'dense_6[1][0]']
 add_3 (Add)                    (None, 1, 1, 128)    0           ['dense_7[0][0]',
                                                                  'dense_7[1][0]']
 activation_3 (Activation)      (None, 1, 1, 128)    0           ['add_3[0][0]']
 multiply_6 (Multiply)          (None, 14, 14, 128)  0           ['max_pooling2d_3[0][0]',
                                                                  'activation_3[0][0]']
 lambda_6 (Lambda)              (None, 14, 14, 1)    0           ['multiply_6[0][0]']
 lambda_7 (Lambda)              (None, 14, 14, 1)    0           ['multiply_6[0][0]']
 concatenate_3 (Concatenate)    (None, 14, 14, 2)    0           ['lambda_6[0][0]',
                                                                  'lambda_7[0][0]']
 conv2d_7 (Conv2D)              (None, 14, 14, 1)    98          ['concatenate_3[0][0]']
 multiply_7 (Multiply)          (None, 14, 14, 128)  0           ['multiply_6[0][0]',
                                                                  'conv2d_7[0][0]']
 flatten (Flatten)              (None, 25088)        0           ['multiply_7[0][0]']
 dense_8 (Dense)                (None, 128)          3211392     ['flatten[0][0]']
 dense_9 (Dense)                (None, 1)            129         ['dense_8[0][0]']
==================================================================================================
Total params: 3,350,733
Trainable params: 3,350,541
Non-trainable params: 192
__________________________________________________________________________________________________
Epoch 1/3
/home/akshat/Documents/Github/homo_env/lib/python3.10/site-packages/keras/optimizers/optimizer_v2/rmsprop.py:135: UserWarning: The `lr` argument is deprecated, use `learning_rate` instead.
  super(RMSprop, self).__init__(name, **kwargs)




50/50 [==============================] - ETA: 0s - loss: 0.6907 - acc: 0.5800
WARNING:absl:Found untraced functions such as _jit_compiled_convolution_op, _jit_compiled_convolution_op, _jit_compiled_convolution_op, _jit_compiled_convolution_op, _jit_compiled_convolution_op while saving (showing 5 of 8). These functions will not be directly callable after loading.
50/50 [==============================] - 34s 605ms/step - loss: 0.6907 - acc: 0.5800 - val_loss: 0.6934 - val_acc: 0.5000
Epoch 2/3
50/50 [==============================] - 23s 460ms/step - loss: 0.6951 - acc: 0.5600 - val_loss: 0.6935 - val_acc: 0.5000
Epoch 3/3




50/50 [==============================] - 23s 461ms/step - loss: 0.6886 - acc: 0.5800 - val_loss: 0.6940 - val_acc: 0.5000
Evalutaing model..
Found 400 images belonging to 2 classes.
Training Loss is:  0.6939850449562073
Training Accuracy is: 50.000
Test Loss is:  0.7020004987716675
Test Accuracy is: 40.000






388/400 [============================>.] - ETA: 0s
/home/akshat/Documents/Github/homo_env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
400/400 [==============================] - 13s 32ms/step
Accuracy: 0.500000
Precision: 0.000000
Recall: 0.000000
F1 score: 0.000000
Cohens kappa: 0.000000
ROC AUC: 0.516825
[[200   0]
 [200   0]]